<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>选中框效果</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .container {
            width: 100%;
            height: 100%;
            position: relative;
            cursor: crosshair;
        }

        .selectable-item {
            position: absolute;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid #333;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
            color: #333;
            transition: all 0.2s ease;
        }

        .selectable-item.selected {
            background: rgba(74, 144, 226, 0.8);
            border-color: #4a90e2;
            box-shadow: 0 0 15px rgba(74, 144, 226, 0.6);
            transform: scale(1.05);
        }

        .selection-box {
            position: absolute;
            background: rgba(74, 144, 226, 0.2);
            border: 2px solid #4a90e2;
            z-index: 1000;
            pointer-events: none;
        }

        .selection-box.active {
            border-style: dashed;
        }

        .selection-box.hidden {
            display: none;
        }

        .info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 14px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <div class="info">
            <p>点击并拖动创建选中框</p>
            <p id="selectedCount">已选中: 0</p>
    </div>

    <script>
        class SelectionBox {
            constructor() {
                this.container = document.getElementById('container');
                this.selectionBox = document.createElement('div');
                this.selectionBox.className = "selection-box hidden";
                this.container.appendChild(this.selectionBox);
                
                this.isSelecting = false;
                this.startX = 0;
                this.startY = 0;
                this.currentX = 0;
                this.currentY = 0;
                this.selectedItems = [];
                
                this.init();
            }

            init() {
                this.createSelectableItems();
                this.setupEventListeners();
            }

            createSelectableItems() {
            // 创建多个可选中元素
                for (let i = 0; i < 12; i++) {
                    const item = document.createElement('div');
                    item.className = 'selectable-item';
                    item.textContent = `元素 ${i + 1}`;
                    
                    // 随机位置
                    const x = Math.random() * (window.innerWidth - 120) + 10;
                    const y = Math.random() * (window.innerHeight - 120) + 10;
                    item.style.left = x + 'px';
                    item.style.top = y + 'px';
                    
                    this.container.appendChild(item);
            }
        }

        setupEventListeners() {
                this.container.addEventListener('mousedown', this.handleMouseDown.bind(this));
                document.addEventListener('mousemove', this.handleMouseMove.bind(this));
                document.addEventListener('mouseup', this.handleMouseUp.bind(this));
        }

        handleMouseDown(e) {
                this.isSelecting = true;
                this.startX = e.clientX;
                this.startY = e.clientY;
                
                // 更新选中框位置
                this.selectionBox.style.left = this.startX + 'px';
                this.selectionBox.style.top = this.startY + 'px';
                this.selectionBox.style.width = '0px';
                this.selectionBox.style.height = '0px';
                this.selectionBox.classList.remove('hidden');
                this.selectionBox.classList.add('active');
            }

        handleMouseMove(e) {
                if (!this.isSelecting) return;
                
                this.currentX = e.clientX;
                this.currentY = e.clientY;
                
                const width = Math.abs(this.currentX - this.startX);
                const height = Math.abs(this.currentY - this.startY);
                
                // 更新选中框尺寸和位置
                const left = Math.min(this.startX, this.currentX);
                const top = Math.min(this.startY, this.currentY);
                
                this.selectionBox.style.left = left + 'px';
                this.selectionBox.style.top = top + 'px';
                this.selectionBox.style.width = width + 'px';
                this.selectionBox.style.height = height + 'px';
            }

        handleMouseUp(e) {
                if (!this.isSelecting) return;
                
                this.isSelecting = false;
                this.selectionBox.classList.remove('active');
                
                // 检查哪些元素被选中
                this.checkSelection();
                
                // 延迟隐藏选中框
                setTimeout(() => {
                    this.selectionBox.classList.add('hidden');
                }, 100);
            }

        checkSelection() {
                const selectionRect = this.selectionBox.getBoundingClientRect();
                const items = document.querySelectorAll('.selectable-item');
                this.selectedItems = [];
                
                items.forEach(item => {
                    const itemRect = item.getBoundingClientRect();
                    
                    if (this.isRectOverlap(selectionRect, itemRect)) {
                        item.classList.add('selected');
                        this.selectedItems.push(item);
                    } else {
                        item.classList.remove('selected');
                    }
                });
                
                this.updateSelectedCount();
            }

        isRectOverlap(rect1, rect2) {
                    return !(rect1.right < rect2.left || 
                           rect1.left > rect2.right || 
                           rect1.bottom < rect2.top || 
                           rect1.top > rect2.bottom);
            }

        updateSelectedCount() {
                document.getElementById('selectedCount').textContent = 
                    `已选中: ${this.selectedItems.length}`;
            }
        }

        // 启动选中框功能
        const selectionBox = new SelectionBox();
    </script>
</body>
</html>